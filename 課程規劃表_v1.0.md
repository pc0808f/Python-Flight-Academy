# 「飛行驅動 Python」18 週課程規劃表

**課程名稱**：飛行驅動 Python - 無人機程式設計實作課程
**適用對象**：高中學生（建議高一、高二）
**課程時數**：每週 2-3 小時，共 18 週（36-54 小時）
**適用課綱**：108 課綱 - 科技領域 / 資訊科技
**授課單位**：內湖高工（申請中）
**版本**：v1.0
**更新日期**：2026-01-30

---

## 一、課程目標

### 1.1 核心能力培養
1. **程式設計能力**：掌握 Python 基礎語法，包含變數、迴圈、條件判斷、函數、資料結構
2. **硬體整合能力**：理解無人機硬體結構，完成組裝與維護
3. **實機操作能力**：具備手動遙控飛行的基本技能與安全意識
4. **程式控制能力**：使用 Python 程式控制無人機完成指定任務

### 1.2 符合 108 課綱素養指標
- **運算思維與問題解決**：透過無人機任務培養演算法思維
- **資訊科技應用**：整合軟硬體知識解決真實問題
- **科技態度與責任**：建立飛行安全意識與除錯能力
- **創新與實作**：期末專題培養創意與整合能力

---

## 二、課程特色

### 2.1 三階段學習模式
1. **模擬器階段（W1-W8）**：使用 Webots 模擬器學習 Python 與基礎飛行控制
2. **實機組裝與手控（W9-W10）**：Crazyflie 無人機組裝與手動飛行訓練
3. **程式實飛階段（W11-W18）**：實體無人機程式控制與專題開發

### 2.2 四大學習面向整合
| 學習面向 | 涵蓋週次 | 學習重點 |
|---------|---------|---------|
| 程式設計 | W1-W18 全程 | Python 語法由淺入深，從基礎到應用 |
| 無人機組裝 | W9 集中學習 | Crazyflie 硬體結構、電路、組裝流程 |
| 無人機駕駛 | W10 + 後續每週 5 分鐘 | 手動遙控、飛行技巧、安全規範 |
| 程式控制飛行 | W3-W8 模擬 + W11-W18 實機 | cflib SDK 控制、感測器應用 |

---

## 三、18 週課程大綱

### 【第一階段】Python 基礎 + 模擬器入門（W1 - W4）

#### W1：Python 環境建置與基礎語法
**學習目標**
- 安裝 Python、VSCode、cflib 套件
- 理解變數、資料型態、print() 輸出

**程式設計**
- 變數宣告與賦值
- 基本資料型態：int, float, str, bool
- 輸出與格式化字串

**實作內容**
- 撰寫第一個 Python 程式
- 計算機程式練習（距離、速度、時間運算）

**作業**
- 撰寫自我介紹程式（包含姓名、年齡、興趣）

---

#### W2：Webots 模擬器環境設置
**學習目標**
- 安裝 Webots 模擬器
- 載入 Crazyflie 模型
- 執行第一個模擬飛行程式

**程式設計**
- import 函式庫概念
- 物件導向初步：建立物件實例

**實作內容**
```python
from controller import Robot

# 建立機器人物件
drone = Robot()
print("模擬無人機已啟動！")
```

**作業**
- 成功在 Webots 中顯示 Crazyflie 並讓馬達轉動

---

#### W3：模擬器中的起飛與降落
**學習目標**
- 在 Webots 中實現起飛與降落
- 理解程式執行的順序性

**程式設計**
- 函數呼叫（Methods）
- time.sleep() 時間控制

**實作內容**
```python
import time

drone.takeoff()
time.sleep(3)  # 懸停 3 秒
drone.land()
```

**飛行任務**
- 基礎任務：起飛 → 懸停 5 秒 → 降落
- 進階任務：連續執行三次起降

---

#### W4：精準高度控制
**學習目標**
- 控制不同高度的懸停
- 理解參數傳遞概念

**程式設計**
- 函數參數（Arguments）
- 整數與浮點數運算

**實作內容**
```python
drone.takeoff(height=0.5)  # 起飛至 50cm
time.sleep(2)
drone.move_up(0.3)         # 再上升 30cm
time.sleep(2)
drone.land()
```

**飛行任務**
- 設計一個「階梯式上升」程式：20cm → 50cm → 80cm → 降落

---

### 【第二階段】模擬器進階控制（W5 - W8）

#### W5：水平移動控制（前後左右）
**學習目標**
- 在 Webots 中實現 X-Y 平面移動

**程式設計**
- 多參數函數
- 變數命名規範

**實作內容**
```python
speed = 0.3  # m/s

drone.takeoff()
drone.move_forward(distance=1.0, speed=speed)
drone.move_backward(distance=1.0, speed=speed)
drone.land()
```

**飛行任務**
- 基礎：前進 1m → 後退 1m → 左移 0.5m → 右移 0.5m
- 進階：繪製一個「十字」飛行路徑

---

#### W6：變數與運算應用
**學習目標**
- 使用變數控制飛行參數
- 基礎算術運算

**程式設計**
- 變數運算（+, -, *, /）
- 變數更新（+=, -=）

**實作內容**
```python
power = 50
altitude = power * 0.01  # 轉換為公尺

drone.takeoff(height=altitude)
power += 20  # 增加動力
drone.move_up(power * 0.01)
```

**飛行任務**
- 設計一個「動態高度」程式，根據變數自動調整飛行高度

---

#### W7：旋轉控制（Yaw）與組合動作
**學習目標**
- 實現原地旋轉與側向移動

**程式設計**
- 浮點數精確度
- 組合多個動作指令

**實作內容**
```python
drone.takeoff()
drone.rotate(90)      # 順時針旋轉 90 度
drone.move_forward(1.0)
drone.rotate(-90)     # 逆時針旋轉 90 度
drone.land()
```

**飛行任務**
- 進階：讓無人機飛出一個「L」形路徑

---

#### W8：幾何飛行挑戰 - 正方形路徑
**學習目標**
- 組合前面所學，完成複雜飛行任務
- 體驗程式碼重複的冗贅感（為迴圈鋪路）

**程式設計**
- 程式碼重構概念
- 註解的重要性

**實作內容**
```python
side_length = 1.0

drone.takeoff()
# 第一邊
drone.move_forward(side_length)
drone.rotate(90)
# 第二邊
drone.move_forward(side_length)
drone.rotate(90)
# 第三邊
drone.move_forward(side_length)
drone.rotate(90)
# 第四邊
drone.move_forward(side_length)
drone.rotate(90)
drone.land()
```

**飛行任務**
- 基礎：正方形路徑（邊長 1m）
- 進階：等邊三角形路徑

**重點引導**
- 提問：「有沒有發現程式碼很重複？有沒有更簡潔的寫法？」（預告 W9 迴圈）

---

### 【第三階段】實體無人機組裝與手控（W9 - W10）

#### W9：Crazyflie 無人機組裝實作
**學習目標**
- 認識 Crazyflie 硬體結構
- 完成無人機組裝
- 建立飛行安全意識

**無人機組裝**（本週重點）
1. **硬體介紹**
   - 主板（STM32 微控制器）
   - 馬達與螺旋槳（順槳/逆槳識別）
   - 電池規格與充電安全
   - 擴充模組（Flow Deck, Multi-ranger Deck）

2. **組裝流程**
   - 馬達座安裝
   - 主板固定
   - 螺旋槳安裝方向確認
   - 電池連接與平衡測試

3. **安全規範**
   - 室內飛行限制
   - 保護罩安裝
   - 緊急降落處理
   - 禁航區規範

**程式設計**
- For 迴圈初步（優化 W8 的正方形程式）

**實作內容**
```python
# 使用迴圈改寫正方形飛行
for i in range(4):
    drone.move_forward(1.0)
    drone.rotate(90)
```

**作業**
- 完成無人機組裝並通過飛行前檢查
- 撰寫「飛行前檢查清單」（Check List）

---

#### W10：手動遙控飛行訓練
**學習目標**
- 掌握手動遙控器操作
- 建立飛行空間感
- 完成基礎手控飛行任務

**無人機駕駛**（本週重點）
1. **遙控器操作**
   - 左搖桿：油門（上下）、偏航（左右）
   - 右搖桿：俯仰（前後）、翻滾（左右）

2. **基礎飛行訓練**
   - 定點懸停（10 秒）
   - 前進與後退（直線 2m）
   - 左右平移
   - 360 度旋轉

3. **安全演練**
   - 緊急降落操作
   - 失控後的恢復
   - 低電量警示處理

**程式設計**
- While 迴圈與無窮迴圈概念

**實作內容**
```python
# 模擬「持續監控」邏輯
battery = 100

while battery > 20:
    print(f"電量：{battery}%，繼續飛行")
    battery -= 10
    time.sleep(1)

print("電量不足，準備降落！")
```

**檢核標準**
- 能夠手動起飛並穩定懸停 30 秒
- 能夠完成「矩形繞行」飛行路線
- 能夠在緊急情況下安全降落

---

### 【第四階段】實機程式控制（W11 - W14）

#### W11：實機連線與基礎飛行
**學習目標**
- 完成電腦與 Crazyflie 的無線連線
- 執行第一個實機 Python 控制程式

**程式控制飛行**（實機首次程式飛行）

**實作內容**
```python
import cflib.crtp
from cflib.crazyflie import Crazyflie
from cflib.crazyflie.syncCrazyflie import SyncCrazyflie

# 初始化驅動
cflib.crtp.init_drivers()

URI = 'radio://0/80/2M/E7E7E7E7E7'

with SyncCrazyflie(URI, cf=Crazyflie(rw_cache='./cache')) as scf:
    cf = scf.cf

    # 起飛
    cf.commander.send_setpoint(0, 0, 0, 30000)  # 油門值
    time.sleep(2)

    # 降落
    cf.commander.send_setpoint(0, 0, 0, 0)
```

**飛行任務**
- 基礎：程式起飛 → 懸停 3 秒 → 降落
- 進階：加入 try-except-finally 確保安全降落

**安全機制**
- 所有程式必須包含異常處理
- 必須在 finally 區塊執行降落指令

---

#### W12：重複巡邏任務（For 迴圈實戰）
**學習目標**
- 使用 for 迴圈實現自動巡邏

**程式設計**
- For 迴圈與 range()
- 巢狀迴圈初步

**實作內容**
```python
# 自動巡邏三次
for lap in range(3):
    print(f"第 {lap + 1} 次巡邏")
    drone.move_forward(1.0)
    drone.rotate(180)
    drone.move_forward(1.0)
    drone.rotate(180)
```

**飛行任務**
- 基礎：來回巡邏 3 次
- 進階：巡邏時每次改變高度（0.3m → 0.5m → 0.7m）

---

#### W13：安全機制 - 電量檢查（If-Else）
**學習目標**
- 讀取無人機電量
- 實現電量不足自動降落

**程式設計**
- 條件判斷式（if, elif, else）
- 布林值與比較運算子

**實作內容**
```python
def check_battery(scf):
    # 讀取電量（需使用 log 系統）
    battery_level = get_battery_level(scf)

    if battery_level < 15:
        print("⚠️ 電量過低！強制降落")
        return False
    elif battery_level < 30:
        print("⚡ 電量偏低，建議降落")
        return True
    else:
        print(f"✓ 電量充足：{battery_level}%")
        return True

# 在飛行前檢查
if check_battery(scf):
    perform_flight()
else:
    print("任務取消")
```

**飛行任務**
- 設計一個「智慧飛行」程式，根據電量決定飛行時間

---

#### W14：互動式控制（Input 與鍵盤事件）
**學習目標**
- 使用 input() 接收使用者指令
- 實現簡易的鍵盤控制飛行

**程式設計**
- input() 函數
- 字串比對與轉換

**實作內容**
```python
def manual_control():
    drone.takeoff()

    while True:
        command = input("輸入指令 (w/a/s/d/q): ").lower()

        if command == 'w':
            drone.move_forward(0.3)
        elif command == 's':
            drone.move_backward(0.3)
        elif command == 'a':
            drone.move_left(0.3)
        elif command == 'd':
            drone.move_right(0.3)
        elif command == 'q':
            print("結束控制")
            break
        else:
            print("無效指令")

    drone.land()
```

**飛行任務**
- 基礎：WASD 四向控制
- 進階：加入高度控制（R/F 鍵）與旋轉（Q/E 鍵）

---

### 【第五階段】感測器應用與進階控制（W15 - W16）

#### W15：高度感測器（ToF）應用
**學習目標**
- 讀取 ToF 感測器數據
- 實現自動高度維持

**程式設計**
- 感測器數據讀取（回傳值）
- 資料型態轉換

**實作內容**
```python
def maintain_altitude(target_height):
    current_height = read_tof_sensor()

    if current_height < target_height - 0.05:
        drone.move_up(0.05)
    elif current_height > target_height + 0.05:
        drone.move_down(0.05)

    print(f"目標：{target_height}m，當前：{current_height}m")
```

**飛行任務**
- 讓無人機自動保持離地 50cm，不論地形高低（可用書本模擬地形變化）

---

#### W16：姿態儀（IMU）與自定義函數
**學習目標**
- 讀取 IMU 數據（Roll, Pitch, Yaw）
- 撰寫自定義飛行函數

**程式設計**
- 函數定義（def）
- 參數預設值
- 字串格式化（f-string）

**實作內容**
```python
def display_attitude(scf):
    # 讀取姿態數據
    roll, pitch, yaw = get_imu_data(scf)
    print(f"翻滾：{roll:.2f}° | 俯仰：{pitch:.2f}° | 偏航：{yaw:.2f}°")

def custom_flip(direction='forward'):
    """自定義翻轉動作"""
    if direction == 'forward':
        # 前空翻指令
        pass
    elif direction == 'backward':
        # 後空翻指令
        pass

# 呼叫自定義函數
custom_flip('forward')
```

**飛行任務**
- 基礎：即時顯示無人機姿態數據
- 進階：撰寫一個 spiral() 螺旋上升函數

---

### 【第六階段】綜合應用與專題（W17 - W18）

#### W17：航點飛行（Lists 應用）
**學習目標**
- 使用列表儲存座標
- 實現自動航點飛行

**程式設計**
- 列表（Lists）的建立與讀取
- for 迴圈遍歷列表

**實作內容**
```python
# 定義航點列表（x, y, z）
waypoints = [
    (0.5, 0, 0.5),
    (0.5, 0.5, 0.5),
    (0, 0.5, 0.5),
    (0, 0, 0.5)
]

drone.takeoff()

for point in waypoints:
    x, y, z = point
    print(f"飛往座標：({x}, {y}, {z})")
    drone.go_to(x, y, z)
    time.sleep(2)

drone.land()
```

**飛行任務**
- 基礎：依序飛行 4 個預設航點
- 進階：設計一個「字母飛行」程式（如飛出 "L" 或 "C" 形狀）

---

#### W18：期末專題發表與成果展示
**學習目標**
- 整合所學完成自訂專題
- 學習除錯與測試
- 口頭報告能力

**專題題目範例**
1. **自動障礙接力賽**：通過三個高度不同的門框
2. **精準投彈模擬**：在指定位置投放物品（輕量物）
3. **編隊飛行演示**（多機）：兩台無人機同步飛行
4. **聲控飛行系統**：整合語音識別控制飛行
5. **自動巡邏與返航**：設定巡邏路線，低電量自動返回起點

**評分標準（總分 100）**
| 項目 | 配分 | 說明 |
|-----|------|------|
| 程式碼品質 | 30 分 | 邏輯清晰、註解完整、變數命名規範 |
| 飛行達成度 | 30 分 | 任務完成度、飛行穩定性 |
| 安全機制 | 20 分 | 異常處理、緊急降落、電量檢查 |
| 創意與應用 | 10 分 | 題目創意、實用性 |
| 口頭報告 | 10 分 | 表達清晰、邏輯完整 |

**專題要求**
- 必須包含至少 3 種程式結構（迴圈、條件、函數）
- 必須有完整的錯誤處理機制
- 需撰寫專題報告（含程式碼說明）
- 現場展示飛行成果（3-5 分鐘）

---

## 四、教學資源與設備需求

### 4.1 軟體環境
| 軟體 | 用途 | 授權 |
|-----|------|------|
| Python 3.8+ | 主要程式語言 | 開源免費 |
| Webots R2023b | 無人機模擬器 | 教育版免費 |
| VSCode | 程式編輯器 | 開源免費 |
| cflib | Crazyflie Python 函式庫 | 開源免費 |
| Git | 版本控制（選用） | 開源免費 |

### 4.2 硬體設備（每組建議）
| 設備 | 數量 | 用途 | 估價（新台幣） |
|-----|------|------|--------------|
| Crazyflie 2.1 無人機 | 1 台 | 主要教學載具 | $6,000 |
| Crazyradio PA | 1 個 | 電腦連線模組 | $1,200 |
| Flow Deck v2 | 1 個 | 定位感測器 | $1,500 |
| Multi-ranger Deck | 1 個 | 障礙物偵測（選用） | $1,800 |
| 備用電池（240mAh） | 3 顆 | 延長使用時間 | $900 |
| 保護罩 | 1 組 | 飛行安全防護 | $600 |
| **單組總計** | - | - | **約 $12,000** |

**建議分組方式**：2-3 人一組（預算考量）

### 4.3 教室環境需求
- 電腦教室（每人一台電腦）
- 室內飛行空間（建議 5m x 5m 以上，挑高 3m）
- 投影設備（教學展示）
- 網路環境（下載軟體與套件）

---

## 五、評量方式

### 5.1 形成性評量（60%）
- **每週作業**（30%）：程式碼繳交與執行結果
- **飛行檢核**（20%）：手控與程式飛行技能測驗
- **課堂參與**（10%）：出席、提問、小組合作

### 5.2 總結性評量（40%）
- **期中測驗**（W9，10%）：Python 基礎語法筆試 + 模擬器飛行任務
- **期末專題**（W18，30%）：專題成果、程式碼、報告、展示

### 5.3 補救教學機制
- 提供課後輔導時間
- 線上教學影片補充
- 學習落後同學個別指導

---

## 六、課程進度總表

| 週次 | 主題 | 程式設計 | 無人機組裝 | 無人機駕駛 | 程式控制飛行 | 使用環境 |
|-----|------|---------|-----------|-----------|------------|---------|
| W1 | Python 環境建置 | ★★★ | - | - | - | 電腦 |
| W2 | Webots 模擬器設置 | ★★ | - | - | ★ | 電腦+模擬器 |
| W3 | 模擬起飛降落 | ★★ | - | - | ★★ | 模擬器 |
| W4 | 精準高度控制 | ★★ | - | - | ★★ | 模擬器 |
| W5 | 水平移動控制 | ★★ | - | - | ★★ | 模擬器 |
| W6 | 變數與運算 | ★★★ | - | - | ★ | 模擬器 |
| W7 | 旋轉與組合動作 | ★★ | - | - | ★★ | 模擬器 |
| W8 | 幾何飛行挑戰 | ★★ | - | - | ★★★ | 模擬器 |
| W9 | 實機組裝 + For 迴圈 | ★★ | ★★★ | ★ | - | 實機組裝 |
| W10 | 手動遙控訓練 | ★ | - | ★★★ | - | 實機手控 |
| W11 | 實機連線與首次程式飛行 | ★★ | - | ★ | ★★★ | 實機程式 |
| W12 | 重複巡邏（For 迴圈） | ★★★ | - | - | ★★ | 實機程式 |
| W13 | 電量檢查（If-Else） | ★★★ | - | - | ★★ | 實機程式 |
| W14 | 互動式控制（Input） | ★★ | - | - | ★★ | 實機程式 |
| W15 | ToF 感測器應用 | ★★ | - | - | ★★★ | 實機程式 |
| W16 | IMU 與自定義函數 | ★★★ | - | - | ★★ | 實機程式 |
| W17 | 航點飛行（Lists） | ★★★ | - | - | ★★★ | 實機程式 |
| W18 | 期末專題發表 | ★★ | - | - | ★★★ | 實機專題 |

**圖例**：★ 少量涉及 | ★★ 中度涉及 | ★★★ 重點學習

---

## 七、課程優勢與創新點

### 7.1 創新教學設計
1. **模擬器先行**：降低硬體損壞風險，學生可在家練習
2. **四面向整合**：軟硬體並重，理論與實作結合
3. **階梯式難度**：從模擬到實機，從手控到程式控制
4. **安全意識融入**：每週強化飛行安全與除錯能力

### 7.2 符合 108 課綱
- **科技領域核心素養**：運算思維、問題解決、創新實作
- **跨領域整合**：數學（座標、向量）、物理（運動學）、資訊（程式設計）
- **實作導向**：70% 實作 + 30% 理論

### 7.3 未來擴充可能
- 整合 AI 影像辨識（OpenCV）
- 多機編隊協作
- 競賽導向訓練（如 TIRT、能力競賽）
- 物聯網整合（MQTT 遠端控制）

---

## 八、預期學習成果

完成本課程後，學生將能夠：

1. ✅ **程式設計能力**
   - 獨立撰寫 100 行以上的 Python 程式
   - 使用變數、迴圈、條件、函數、列表等基礎語法
   - 閱讀與除錯他人的程式碼

2. ✅ **硬體整合能力**
   - 完成 Crazyflie 無人機組裝與維護
   - 理解感測器原理與應用
   - 解決基本的硬體故障問題

3. ✅ **實機操作能力**
   - 手動遙控完成基礎飛行任務
   - 建立飛行安全意識
   - 處理緊急情況（失控、低電量）

4. ✅ **程式控制能力**
   - 使用 Python 控制無人機完成指定任務
   - 整合感測器數據進行自主飛行
   - 設計並實現自訂飛行專題

---

## 九、聯絡資訊

**課程負責人**：（待填寫）
**聯絡信箱**：（待填寫）
**專案網址**：https://github.com/（待建立）

---

**附註**：本課程規劃為第一版草案，將依實際教學情況進行滾動式修正。
